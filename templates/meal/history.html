{% extends 'base.html' %}

{% block header %}
{{ block.super }}
<div class="alert alert-dark" role="alert">
  <h2 class="text-center">履歴</h2>
</div>
{% endblock header %}

{% block content %}
<div class="container mt-4" style="max-width:900px;">
  {% if history %}
    {% for date, items in history %}
      <div class="mb-4">
        <h5 class="mb-2">{% if date %}{{ date|date:"Y年n月j日" }}{% else %}未設定{% endif %}</h5>
        <ul class="list-group">
          {% for item in items %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <strong>{{ item.title }}</strong><br>
                <small class="text-muted">{{ item.category }} / 日付: {% if item.duedate %}{{ item.duedate|date:"Y年n月j日" }}{% else %}未設定{% endif %}</small>
              </div>
              <div class="btn-group">
                <a href="{% url 'todo:meal_detail' item.pk %}" class="btn btn-sm btn-primary">詳細</a>
                <a href="{% url 'todo:meal_update' item.pk %}" class="btn btn-sm btn-secondary">編集</a>
                <a href="{% url 'todo:meal_delete' item.pk %}" class="btn btn-sm btn-danger">削除</a>
              </div>
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endfor %}
  {% else %}
    <div class="alert alert-info">履歴がありません。新しいメモを登録してください。</div>
  {% endif %}

  <div class="mt-3">
    <a href="{% url 'todo:meal_list' %}" class="btn btn-secondary">一覧へ戻る</a>
    <a href="{% url 'todo:top' %}" class="btn btn-outline-secondary">トップへ戻る</a>
  </div>
</div>
{% endblock content %}